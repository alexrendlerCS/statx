<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Player Stats Search</title>
    <script>
        async function searchPlayer(event) {
            event.preventDefault();
            const playerName = document.getElementById('player_name').value;

            try {
                const response = await fetch('/api/searchPlayer', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ player_name: playerName })
                });
                
                const data = await response.json();

                // Display results in HTML
                let resultDiv = document.getElementById('result');
                resultDiv.innerHTML = '';

                if (response.ok) {
                    const rows = data.data;
                    let tableHTML = `<table border='1'>
                        <tr><th>ID</th><th>Player Name</th><th>Week</th><th>Receiving Yards</th><th>Receptions</th><th>Targets</th><th>Touchdowns</th></tr>`;
                    
                    rows.forEach(row => {
                        tableHTML += `<tr>
                            <td>${row.my_row_id}</td>
                            <td>${row.player_name}</td>
                            <td>${row.week}</td>
                            <td>${row.receiving_yards}</td>
                            <td>${row.receptions}</td>
                            <td>${row.targets}</td>
                            <td>${row.touchdowns}</td>
                        </tr>`;
                    });
                    tableHTML += '</table>';
                    resultDiv.innerHTML = tableHTML;
                } else {
                    resultDiv.innerHTML = `<p>${data.message || data.error}</p>`;
                }
            } catch (error) {
                console.error("Error fetching player data:", error);
                document.getElementById('result').innerHTML = "<p>An error occurred while fetching player data.</p>";
            }
        }
    </script>
</head>
<body>
    <h1>Search Player Stats</h1>
    <form onsubmit="searchPlayer(event)">
        <label for="player_name">Enter Player Name:</label>
        <input type="text" id="player_name" name="player_name" required>
        <button type="submit">Search</button>
    </form>
    <div id="result"></div>
</body>
</html>
